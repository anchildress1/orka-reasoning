# OrKa-Reasoning ‚Äì Un-official CHANGELOG  
*(derived from the public-repo commit history as of **May 10 2025**)*  

---

## [0.6.5] ¬∑ 2025-01-29
### Added
* **Memory Decay System - Intelligent Memory Management**
  * **Automatic Memory Classification** - Smart classification of memory entries as short-term or long-term based on importance and event type
  * **Agent-Level Decay Configuration** - Per-agent decay settings that override global configuration for fine-grained control
  * **Configurable Retention Policies** - Separate retention periods for short-term and long-term memories with hour-based precision
  * **Importance Scoring Algorithm** - Dynamic importance calculation based on event types, agent types, and payload content
  * **Background Cleanup Scheduler** - Automatic cleanup of expired memories with configurable check intervals
  * **Memory Type Rules Engine** - Configurable rules for classifying events as long-term or short-term based on event types
  * **Decay Metadata Tracking** - Comprehensive metadata including importance scores, memory types, creation time, and expiration time
* **Enhanced Memory Reader System - Advanced Context-Aware Search**
  * **Context-Enhanced Search** - Memory reader now uses conversation history and previous outputs for more relevant memory retrieval
  * **Hybrid Scoring Algorithm** - Combines semantic similarity, keyword matching, context overlap, and temporal decay for optimal relevance ranking
  * **Enhanced Query Variations** - Intelligent generation of query variations using entity extraction and context keywords for broader search coverage
  * **Temporal Ranking** - Time-based scoring that prioritizes recent memories while maintaining relevance to older important memories
  * **Advanced Filtering** - Multi-criteria filtering with configurable thresholds for semantic similarity, keyword matching, and context relevance
  * **Deterministic Search Results** - Consistent and reproducible search results with proper handling of edge cases and timestamp variations
  * **Backward Compatibility** - Enhanced features are opt-in with full compatibility for existing memory reader configurations
* **Enhanced CLI Memory Management Interface**
  * **Real-time Memory Monitoring** - `orka memory watch` command with professional dashboard using Rich library
  * **Memory Statistics** - `orka memory stats` command showing detailed memory usage and decay configuration
  * **Manual Cleanup** - `orka memory cleanup` command for on-demand expired memory removal
  * **Configuration Display** - `orka memory configure` command showing current decay settings and environment variables
  * **Adaptive Layout** - Compact mode and dynamic sizing for different workflow complexities
  * **Color-coded Memory Types** - Visual distinction between short-term (üî•), long-term (üíæ), and unknown (‚ùì) memories
* **Advanced Memory Configuration Options**
  * **Global Decay Configuration** - Orchestrator-level settings for default retention periods and importance rules
  * **Agent-Specific Overrides** - Individual agent decay settings that merge with global configuration
  * **Environment Variable Support** - Full configuration via environment variables for deployment flexibility
  * **Memory Type Forcing** - `default_long_term` setting to force agent memories into specific retention categories
  * **Flexible Time Configuration** - Support for fractional hours (e.g., 0.025 hours = 1.5 minutes) for testing and fine-tuning
### Changed
* **Memory Logger Architecture Enhancement**
  * **Decay-Aware Logging** - All memory loggers now support decay metadata and agent-specific configuration
  * **Deep Configuration Merging** - Intelligent merging of global and agent-level decay settings
  * **Enabled by Default** - Memory decay now enabled by default for better memory management
  * **Backward Compatibility** - Existing configurations continue to work without modification
* **Memory Reader Node Improvements**
  * **Enhanced Search Capabilities** - Memory reader now supports context-aware search with conversation history integration
  * **Improved Relevance Scoring** - Advanced hybrid scoring combining multiple relevance factors for better memory retrieval
  * **Configurable Search Parameters** - New configuration options for context weight, temporal weight, and search thresholds
  * **Performance Optimization** - More efficient memory scanning and relevance calculation for faster search results
* **Agent Factory Integration**
  * **Automatic Decay Injection** - Agent factory automatically extracts and injects decay configuration into memory nodes
  * **Memory Logger Passing** - Memory writer nodes now receive memory logger instances for decay-aware storage
  * **Configuration Validation** - Enhanced validation of decay configuration parameters
### Fixed
* **Memory Writer Node Integration**
  * **Proper Decay Application** - Memory writer nodes now use memory logger for decay-aware storage instead of direct Redis writes
  * **Agent-Level Configuration Support** - Fixed agent-specific decay settings not being applied to memory entries
  * **Memory Type Classification** - Corrected memory type classification to respect agent-level `default_long_term` settings
* **Memory Reader Search Accuracy**
  * **Query Variation Generation** - Fixed entity extraction and punctuation handling for more accurate query variations
  * **Namespace Consistency** - Resolved namespace mismatch issues between memory storage and retrieval
  * **Temporal Scoring Precision** - Fixed timestamp conversion thresholds for accurate temporal decay calculations
  * **Context Integration** - Improved context keyword extraction and deterministic ordering for consistent search results
* **Statistics Accuracy**
  * **Active Entry Counting** - Memory statistics now correctly count only active (non-expired) entries
  * **Expired Entry Tracking** - Separate tracking of expired entries without inflating active counts
  * **Memory Type Distribution** - Accurate distribution counts for short-term, long-term, and unknown memory types
### Technical Details
* **Decay Algorithm Implementation** - Sophisticated importance scoring with configurable boost factors for different event and agent types
* **Enhanced Memory Search Algorithm** - Multi-factor relevance scoring with semantic, keyword, context, and temporal components
* **Thread-Safe Background Processing** - Daemon thread scheduler for automatic cleanup with proper shutdown handling
* **Rich UI Integration** - Professional terminal interface with live updates, progress bars, and adaptive layouts
* **Cross-Platform Compatibility** - Full Windows, macOS, and Linux support with fallback modes for terminal limitations
* **Comprehensive Testing** - Extensive test coverage for decay functionality, enhanced memory reader, CLI commands, and edge cases
* **Performance Optimization** - Efficient memory scanning and cleanup with minimal impact on orchestration performance

## [0.6.4] ¬∑ 2025-01-28
### Changed
* **Major Architectural Refactoring - Monolithic File Decomposition**
  * **Memory Logger Modularization** - Split `memory_logger.py` from 1,813 lines into focused components:
    * `base_logger.py` (273 lines) - BaseMemoryLogger abstract class with core interface
    * `serialization.py` (160 lines) - JSON sanitization and memory processing utilities
    * `file_operations.py` (180 lines) - Save/load functionality with file I/O operations
    * `redis_logger.py` (420 lines) - Complete RedisMemoryLogger implementation
    * `__init__.py` (35 lines) - Package initialization with proper component imports
    * Updated `memory_logger.py` (218 lines) - Factory function and backward compatibility layer
    * **88% code reduction** (1,813 ‚Üí 218 lines) while maintaining 100% API compatibility
  * **Orchestrator Modularization** - Split `orchestrator.py` from 1,345 lines into specialized components:
    * `base.py` (90 lines) - OrchestratorBase class with initialization and configuration
    * `agent_factory.py` (180 lines) - AgentFactory with AGENT_TYPES registry and agent initialization
    * `prompt_rendering.py` (70 lines) - PromptRenderer with Jinja2 template processing
    * `error_handling.py` (180 lines) - ErrorHandler with comprehensive error tracking and reporting
    * `metrics.py` (220 lines) - MetricsCollector with LLM metrics and runtime environment detection
    * `execution_engine.py` (120 lines) - ExecutionEngine with main execution loop and agent coordination
    * `__init__.py` - Package initialization with component imports
    * New `Orchestrator` class using multiple inheritance composition pattern
    * **96% code reduction** (1,345 ‚Üí 60 lines) while preserving identical public API
* **Architecture Improvements**
  * **Mixin Pattern Implementation** - Used multiple inheritance to compose functionality from specialized components
  * **Zero-Impact Refactoring** - All extracted code moved exactly as-is with no behavioral changes
  * **Enhanced Maintainability** - Created 12 focused, single-responsibility modules from 2 monolithic files
  * **Method Resolution Order Preservation** - Maintained identical method resolution to ensure unchanged behavior
### Added
* **Modular Package Structure**
  * New `orka/memory_logger/` package with 6 specialized modules
  * New `orka/orchestrator/` package with 7 specialized modules  
  * Comprehensive `__init__.py` files ensuring proper component exposure
  * Factory functions and composition classes for seamless integration
### Fixed
* **Code Organization & Technical Debt**
  * **Massive Code Reduction** - Eliminated 2,740 lines of monolithic code (92% overall reduction)
  * **Import Compatibility** - All existing imports continue to work without modification
  * **API Preservation** - Every public method remains accessible in identical locations
  * **Test Compatibility** - All existing tests pass without changes
  * **Backward Compatibility** - 100% compatibility maintained for all existing code using these components
### Technical Details
* **Phase 1: Memory Logger** - Successfully decomposed complex logging system into maintainable components
* **Phase 2: Orchestrator** - Transformed complex orchestration logic into specialized, testable modules
* **Composition Strategy** - Used multiple inheritance composition to maintain API while improving internal structure
* **Zero Regression Policy** - Rigorous testing ensured no functionality changes during refactoring process
* **Future-Proof Architecture** - New modular structure enables easier maintenance, testing, and feature development

## [0.6.3] ¬∑ 2025-01-27
### Fixed
* **Critical Docker Integration Bug**
  * Fixed "docker-compose file not available" error when running `orka.orka_start` after pip installation
  * Enhanced package distribution configuration to properly include docker directory and all its contents
  * Updated `MANIFEST.in` to explicitly include `orka/docker/*` files in the package
  * Improved `setup.py` and `pyproject.toml` package data configuration with recursive docker file inclusion
  * Docker-compose.yml and related infrastructure files now properly bundled with pip installations
* **Package Distribution Improvements**
  * Enhanced setuptools configuration for better file inclusion in wheel distributions
  * Added comprehensive package data patterns to ensure all necessary docker files are included
  * Improved reliability of `get_docker_dir()` function for both development and production environments

## [0.6.2] ¬∑ 2025-06-08
### Added
* **Real Local-Cost Model Implementation**
  * New `LocalCostCalculator` class replacing fantasy $0.00 costs with actual operational expenses
  * Three configurable cost policies: `calculate` (default), `null_fail` (strict), `zero_legacy` (deprecated)
  * Model-aware GPU utilization calculations with electricity consumption + hardware amortization
  * Regional electricity rate defaults and environment variable configuration support
  * Cost comparison analysis: Local models 4.5x cheaper than cloud even with real operational costs
* **Enhanced Blob Storage & Deduplication**
  * Improved blob deduplication system in memory logger with SHA-256 hashing
  * Enhanced blob reference resolution with configurable storage options
  * Better memory efficiency for large payload objects and file attachments
  * Versioned blob storage format with backward compatibility
* **Advanced Reporting & Metrics System**
  * Comprehensive meta report aggregation with real cost tracking and performance metrics
  * Enhanced execution time tracking, token counting, and latency analysis
  * Structured cost breakdowns showing electricity vs. hardware amortization components
  * Improved report formatting with detailed agent performance analytics
* **Memory Logger Versioning & Format Evolution**
  * Enhanced memory logger with versioned storage formats and migration support
  * Improved JSON sanitization with cycle detection to prevent infinite recursion
  * Better payload processing with deduplication-aware formatting
  * Enhanced file save/load operations with format validation
### Changed
* **Test Suite Architecture Overhaul**
  * All **295 tests** now passing with **70% coverage** (improved from previous versions)
  * Comprehensive Kafka memory test infrastructure with robust import mocking
  * Enhanced test isolation and mocking strategies across all modules
  * Fixed orchestrator tests to handle graceful error management instead of raw exceptions
  * Updated start script tests for new environment variable handling
* **Agent Response Structure Enhancement**
  * `LocalLLMAgent` now returns structured responses with cost metrics and performance data
  * Improved agent result formatting with consistent metadata across all agent types
  * Enhanced error handling and retry mechanisms with detailed failure reporting
  * Better integration between cost calculation and existing metrics systems
* **Infrastructure & Configuration Management**
  * Enhanced environment variable handling for deployment flexibility
  * Improved Docker and service startup configurations
  * Better error handling and graceful degradation across all components
  * Enhanced logging and debugging capabilities for production deployments
### Fixed
* **Critical Test Infrastructure Issues**
  * Resolved all Kafka memory logger test failures with comprehensive import mocking
  * Fixed orchestrator error handling tests to match new graceful error management patterns
  * Updated start script tests for new backend parameter requirements and environment handling
  * Enhanced mock environments to prevent dependency conflicts during testing
* **Memory Management & Performance**
  * Fixed memory logger recursion errors when sanitizing Mock objects with circular references
  * Improved JSON serialization handling for complex nested objects and blob references
  * Enhanced cleanup procedures for Redis and Kafka connections during shutdown
  * Better resource management and garbage collection for long-running processes
* **Production Readiness & Reliability**
  * Eliminated misleading $0.00 cost placeholders that provided incorrect economic signals
  * Added robust cost validation and null cost handling for production pipeline enforcement
  * Improved error messages and debugging information across all system components
  * Enhanced configurability for different deployment environments and use cases
### Documentation
* **Comprehensive Configuration Guides**
  * Environment variable documentation for cost calculation, blob storage, and metrics tuning
  * Examples of cost analysis workflows and optimization strategies
  * Guidelines for production deployment with strict cost enforcement policies
  * Regional configuration examples and deployment best practices

## [0.6.1] ¬∑ 2025-06-07
### Fixed
* **Critical Search Tool Bug**
  * Fixed DuckDuckGo search tool receiving raw template strings instead of formatted prompts
  * Search queries now properly resolve template variables (e.g., `{{ previous_outputs['agent_id'] }}`)
  * Orchestrator now renders prompts **before** agent execution instead of after
  * Search results now correctly match the intended search queries
* **Orchestrator Execution Flow**
  * Fixed incomplete `if` statement in parallel agent execution causing syntax errors
  * Added formatted prompts to payload data across all execution paths (RouterNode, ForkNode, JoinNode, normal agents)
  * Fixed `previous_outputs` update timing in parallel execution - agents now see only results from previously completed agents
  * Improved error handling for prompt template rendering with graceful fallbacks
* **Code Quality Improvements**
  * Refactored duplicated prompt handling code into reusable helper methods (`_render_agent_prompt`, `_add_prompt_to_payload`)
  * Fixed timezone-aware datetime usage for UTC timestamps (replaced deprecated `datetime.utcnow()`)
  * Enhanced payload data consistency across sequential and parallel execution paths
### Changed
* **Prompt Processing Architecture**
  * Template rendering now occurs before agent execution for immediate availability
  * Search tools prioritize `formatted_prompt` from orchestrator over raw prompt templates
  * Improved separation of concerns between execution-time and logging-time prompt handling

## [0.6.0] ¬∑ 2025-06-07
### Added
* **Kafka Memory Backend Support**
  * Comprehensive `KafkaMemoryLogger` implementation with full feature parity to Redis backend
  * Support for hash operations, set operations, key-value storage, and event logging via Kafka
  * Factory function `create_memory_logger()` for dynamic backend selection via environment variables
  * Docker configuration and documentation for Kafka setup and integration
  * 21 comprehensive test cases covering initialization, logging, data operations, and error handling
* **Enhanced Resource Registry System**  
  * Complete test coverage (0% ‚Üí 98%) for `ResourceRegistry` with 20 new test cases
  * Support for Redis, OpenAI, SentenceTransformer, and custom resource types
  * Comprehensive error handling and resource lifecycle management testing
  * Dynamic resource initialization with proper cleanup and connection management
* **Robust Test Infrastructure**
  * **295 total tests** passing with **73% overall coverage** (improved from 71%)
  * Fork Group Manager coverage improved from 51% ‚Üí 99% with 32 comprehensive tests
  * Fixed critical recursion errors in memory logger JSON sanitization
  * Enhanced mock strategies for Kafka integration without requiring actual Kafka installation
  * Improved test isolation and reliability across different environments
### Changed
* **Dependency Management**
  * Made DuckDuckGo search import optional to resolve PyO3 compatibility issues
  * Enhanced error handling for missing optional dependencies (sentence-transformers, huggingface-hub)
  * Coverage calculation now excludes start scripts (start_kafka.py, start_redis.py) for cleaner metrics
* **Memory Logger Architecture**
  * Improved JSON sanitization with cycle detection to prevent infinite recursion
  * Enhanced logging error handling during system shutdown to prevent I/O operation errors
  * Better error messages and graceful degradation for missing dependencies
### Fixed
* **Test Suite Stability**
  * Resolved JoinNode test failures with proper mock `hget`/`hset` method implementations  
  * Fixed memory logger recursion errors when sanitizing Mock objects with circular references
  * Improved start script testing without problematic import dependencies
  * Enhanced fork/join node functionality with proper retry count handling
* **Logging and Error Handling**
  * Fixed logging system shutdown errors in RedisMemoryLogger and KafkaMemoryLogger
  * Improved error handling for resource cleanup during application termination
  * Better exception handling and error reporting across memory backend operations

---

## [0.5.9] ¬∑ 2025-06-01
### Added
* **LocalLLMAgent** - New agent type for local LLM integration
  * Support for multiple local LLM providers: Ollama, LM Studio, OpenAI-compatible APIs
  * Dedicated `local_llm_agents.py` module for better separation from cloud agents
  * Template-based prompt handling with `{{ input }}` substitution
  * Configurable model endpoints, temperature, and provider selection
  * Full integration with OrKa agent registry and orchestrator
* **Comprehensive example workflows**
  * `comprehensive_research_analysis.yml` - Demonstrates all agent types and nodes
  * Research paper analysis workflow using hybrid local + cloud processing
  * Shows parallel processing, conditional routing, memory operations, and failover
* **Enhanced agent modularity**
  * Separated local LLM agents from OpenAI agents for cleaner architecture
  * Updated agent registry and orchestrator to support new agent type
  * Comprehensive test suite for LocalLLMAgent with multiple provider scenarios
### Changed
* Agent imports reorganized for better modularity and separation of concerns
* Example configurations updated to showcase hybrid local + cloud workflows
* Documentation expanded with local LLM integration patterns
### Fixed
* Improved error handling for local model connection failures
* Better template substitution and input validation for local agents

---

## [0.5.8] ¬∑ 2025-05-25
### Added
* New `ValidationAndStructuringAgent` for validating and structuring answers into memory format
  * Supports custom memory object templates
  * Provides validation status and reasoning
  * Integrates with existing memory system
### Changed
* Enhanced LLM agent parameters:
  * Added support for model-specific parameters in YAML config
  * Improved temperature and model selection handling
  * Better error handling for model responses
### Fixed
* Documentation now properly hosted at orkacore.web.app/docs
* Fixed Sphinx documentation generation for new agent
* Improved test coverage for validation agent

---

## [0.5.7] ¬∑ 2025-05-18
### Changed
* Consolidated test suite into domain-specific files for better organization and maintenance.
* Updated CI workflow to run domain-based tests for improved clarity and efficiency.
* Added deprecation markers to legacy test files while preserving test coverage.

---

## [0.5.6] ¬∑ 2025-05-17
### Fixed
* LLM agent test suite now uses unified mocking ensuring reliability across local runs and GitHub Actions.
* CI workflow updated to set `PYTEST_RUNNING` early and avoid skipping coverage.
* Documentation and import paths adjusted for `LegacyBaseAgent`.

---

## [0.5.5] ¬∑ 2025-05-10
### Changed
* Bumped version to **0.5.5** in *pyproject.toml* / *setup.py*.  
* Polished README (new badges, wording) and expanded docs.  
* Refactored CI scripts & Codecov wiring; test-badge now green. :contentReference[oaicite:0]{index=0}  

---

## [0.5.2] ¬∑ 2025-05-10
### Added
* Initial **Codecov** integration & coverage upload workflow.  
* Extra unit-tests ‚áí higher overall coverage.  
### Changed
* Project metadata set to **0.5.2**. :contentReference[oaicite:1]{index=1}  

---

## [0.5.0] ¬∑ 2025-05-10  
*(tag implied by version bump in later commits)*  
### Added
* **Service-node / Memory subsystem**  
  * `MemoryReaderNode`, `MemoryWriterNode`, `memory_logger.py`  
  * JSON-sanitising logger + Redis backing.  
  * Embedding utility (`utils/embedder.py`) for future RAG hooks.  
* >2 kLoC of tests covering the new nodes and logger.  
### Changed
* Orchestrator patched to wire per-node embeddings & scoped memory. :contentReference[oaicite:2]{index=2}  

---

## [0.3.7] ¬∑ 2025-05-03
### Added
* Docker artefacts (`orka/docker/*`, root `docker-compose.yml`).  
* `orka_start.py` ‚Äî one-shot CLI launcher for Redis + backend.  
### Changed
* README completely reorganised; clearer "PIP Installation" and YAML sample. :contentReference[oaicite:3]{index=3}  

---

## [0.3.64] ¬∑ 2025-05-03
### Added
* Repo-wide branding refresh (new logo URL, website link).  
* Additional Codecov / Test badges.  
### Changed
* README tweaks, Dockerfile re-location, misc path fixes. :contentReference[oaicite:4]{index=4}  

---

## [0.3.6] ¬∑ 2025-05-03
### Added
* **CLI `orka-start`** docs & helper text.  
* Bulk test suite (`test_orka_*`, fake-Redis) + coverage scripts.  
### Changed
* README: quick-start for full stack via Docker Compose. :contentReference[oaicite:5]{index=5}  

---

## [0.3.5] ¬∑ 2025-05-02
### Added
* First **fork/join** logic polish ‚Äì big diff in `join_node.py`.  
* Example YAML (`example.yml`) with agent definitions.  
### Changed
* `ORKA` LLM agent temperature default raised to 1.0. :contentReference[oaicite:6]{index=6}  

---

> **Note:** versions earlier than 0.3.5 are not tagged in the public repo; private `orca-core` work (0.4.x) is outside this history.

